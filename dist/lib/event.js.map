{"version":3,"sources":["../../lib/event.js"],"names":["mongoose","require","moment","module","exports","EventSchema","Schema","name","type","String","required","data","Object","context","event_time","Number","default","valueOf","collection","Model","model","e"],"mappings":"AAAA;;AACA,IAAIA,WAAWC,QAAQ,UAAR,CAAf;AACA,IAAIC,SAASD,QAAQ,QAAR,GAAb;AACAE,OAAOC,OAAP,GAAiB,YAAY;AAC3B,MAAIC,cAAc,IAAIL,SAASM,MAAb,CAAoB;AACpCC,UAAM,EAACC,MAAMC,MAAP,EAAeC,UAAU,IAAzB,EAD8B;AAEpCC,UAAM,EAACH,MAAMI,MAAP,EAF8B;AAGpCC,aAAS,EAACL,MAAMI,MAAP,EAH2B;AAIpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAE,gBAAY,EAACN,MAAMO,MAAP,EAAeL,UAAU,IAAzB,EAA+BM,SAASd,OAAOe,OAAP,EAAxC;AAdwB,GAApB,EAef,EAACC,YAAY,OAAb,EAfe,CAAlB;AAgBA,MAAIC,cAAJ;AACA,MAAI;AACF;AACAA,YAAQnB,SAASoB,KAAT,CAAe,OAAf,CAAR;AACD,GAHD,CAGE,OAAOC,CAAP,EAAU;AACVF,YAAQnB,SAASoB,KAAT,CAAe,OAAf,EAAwBf,WAAxB,CAAR;AACD;AACD,SAAOc,KAAP;AAED,CA1BD","file":"event.js","sourcesContent":["'use strict'\nvar mongoose = require('mongoose')\nlet moment = require('moment')()\nmodule.exports = function () {\n  let EventSchema = new mongoose.Schema({\n    name: {type: String, required: true},\n    data: {type: Object},\n    context: {type: Object},\n    // context: {\n    //   type: {\n    //     target_id: {type: mongoose.Schema.Types.ObjectId},\n    //     context_type: {\n    //       type: String,\n    //       required: true\n    //       // enum: ['user', 'bot', 'block', 'session']\n    //     }\n    //   }\n    // },\n    event_time: {type: Number, required: true, default: moment.valueOf()}\n  }, {collection: 'event'})\n  let Model\n  try {\n    // Throws an error if \"Name\" hasn't been registered\n    Model = mongoose.model('event')\n  } catch (e) {\n    Model = mongoose.model('event', EventSchema)\n  }\n  return Model\n\n}"]}