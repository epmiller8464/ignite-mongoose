{"version":3,"sources":["../../lib/token.js"],"names":["mongoose","require","moment","module","exports","Model","tokenSchema","Schema","token","type","String","required","issued_on","Number","default","valueOf","jwt_id","blackListed","Boolean","revoked","enum","collection","index","unique","jwtid","model","e"],"mappings":"AAAA;;AACA,IAAMA,WAAWC,QAAQ,UAAR,CAAjB;AACA,IAAIC,SAASD,QAAQ,QAAR,GAAb;;AAEAE,OAAOC,OAAP,GAAiB,YAAY;AAC3B,MAAIC,cAAJ;;AAEA,MAAIC,cAAc,IAAIN,SAASO,MAAb,CAAoB;AACpCC,WAAO,EAACC,MAAMC,MAAP,EAAeC,UAAU,IAAzB,EAD6B;AAEpCC,eAAW,EAACH,MAAMI,MAAP,EAAeF,UAAU,IAAzB,EAA+BG,SAASZ,OAAOa,OAAP,EAAxC,EAFyB;AAGpCC,YAAQ,EAACP,MAAMC,MAAP,EAAeC,UAAU,IAAzB,EAH4B;AAIpCM,iBAAa,EAACR,MAAMS,OAAP,EAAgBP,UAAU,IAA1B,EAAgCG,SAAS,KAAzC,EAJuB;AAKpCK,aAAS,EAACV,MAAMS,OAAP,EAAgBP,UAAU,IAA1B,EAAgCG,SAAS,KAAzC,EAL2B;AAMpCL,UAAM,EAACA,MAAMC,MAAP,EAAeC,UAAU,IAAzB,EAA+BS,MAAM,CAAC,cAAD,EAAiB,SAAjB,EAA4B,QAA5B,CAArC;AAN8B,GAApB,EAOf,EAACC,YAAY,OAAb,EAPe,CAAlB;;AASAf,cAAYgB,KAAZ,CAAkB,EAACd,OAAO,CAAR,EAAlB,EAA8B,EAACe,QAAQ,IAAT,EAA9B;AACAjB,cAAYgB,KAAZ,CAAkB,EAACE,OAAO,CAAR,EAAlB,EAA8B,EAACD,QAAQ,IAAT,EAA9B;AACAjB,cAAYgB,KAAZ,CAAkB,EAACb,MAAM,CAAP,EAAlB;;AAEA,MAAI;AACF;AACAJ,YAAQL,SAASyB,KAAT,CAAe,OAAf,CAAR;AACD,GAHD,CAGE,OAAOC,CAAP,EAAU;AACVrB,YAAQL,SAASyB,KAAT,CAAe,OAAf,EAAwBnB,WAAxB,CAAR;AACD;AACD,SAAOD,KAAP;AACD,CAvBD","file":"token.js","sourcesContent":["'use strict'\nconst mongoose = require('mongoose')\nlet moment = require('moment')()\n\nmodule.exports = function () {\n  let Model\n\n  let tokenSchema = new mongoose.Schema({\n    token: {type: String, required: true},\n    issued_on: {type: Number, required: true, default: moment.valueOf()},\n    jwt_id: {type: String, required: true},\n    blackListed: {type: Boolean, required: true, default: false},\n    revoked: {type: Boolean, required: true, default: false},\n    type: {type: String, required: true, enum: ['verification', 'refresh', 'access']}\n  }, {collection: 'token'})\n\n  tokenSchema.index({token: 1}, {unique: true})\n  tokenSchema.index({jwtid: 1}, {unique: true})\n  tokenSchema.index({type: 1})\n\n  try {\n    // Throws an error if \"Name\" hasn't been registered\n    Model = mongoose.model('token')\n  } catch (e) {\n    Model = mongoose.model('token', tokenSchema)\n  }\n  return Model\n}"]}