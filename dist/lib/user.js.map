{"version":3,"sources":["../../lib/user.js"],"names":["mongoose","require","moment","module","exports","Model","UserSchema","Schema","name","type","String","displayName","date_added","Number","required","default","valueOf","profile_url","email","trim","lowercase","minLength","match","accessToken","refreshToken","email_verified","Boolean","provider_id","auth_id","provider","profile","Object","flags","picture_url","has_connected_bots","pages_access","subscriptions_access","payments_access","bot_subscriptions","Types","ObjectId","ref","ip","history","collection","index","model","e"],"mappings":"AAAA;;AACA,IAAIA,WAAWC,QAAQ,UAAR,CAAf;AACA,IAAIC,SAASD,QAAQ,QAAR,GAAb;;AAEAE,OAAOC,OAAP,GAAiB,YAAY;;AAE3B,MAAIC,cAAJ;;AAEA,MAAIC,aAAa,IAAIN,SAASO,MAAb,CAAoB;AACnCC,UAAM,EAACC,MAAMC,MAAP,EAD6B;AAEnCC,iBAAa,EAACF,MAAMC,MAAP,EAFsB;AAGnCE,gBAAY,EAACH,MAAMI,MAAP,EAAeC,UAAU,IAAzB,EAA+BC,SAASb,OAAOc,OAAP,EAAxC,EAHuB;AAInCC,iBAAa,EAACR,MAAMC,MAAP,EAJsB;AAKnCQ,WAAO;AACLT,YAAMC,MADD,EACSS,MAAM,IADf,EACqBC,WAAW,IADhC,EACsCN,UAAU,KADhD,EACuDO,WAAW,CADlE,EACqEC,OAAO;AAD5E,KAL4B;AAQnCC,iBAAa,EAACd,MAAMC,MAAP,EARsB;AASnCc,kBAAc,EAACf,MAAMC,MAAP,EATqB;AAUnCe,oBAAgB,EAAChB,MAAMiB,OAAP,EAVmB;AAWnCC,iBAAa,EAAClB,MAAMC,MAAP,EAXsB;AAYnCkB,aAAS,EAACnB,MAAMC,MAAP,EAZ0B;AAanCmB,cAAU,EAACpB,MAAMC,MAAP,EAbyB;AAcnCoB,aAAS,EAACrB,MAAMsB,MAAP,EAd0B;AAenCC,WAAO,CAACtB,MAAD,CAf4B;AAgBnCuB,iBAAa,EAACxB,MAAMC,MAAP,EAhBsB;AAiBnCwB,wBAAoB,EAACzB,MAAMiB,OAAP,EAAgBZ,UAAU,IAA1B,EAAgCC,SAAS,KAAzC,EAjBe;AAkBnCoB,kBAAc,EAAC1B,MAAMiB,OAAP,EAAgBZ,UAAU,IAA1B,EAAgCC,SAAS,KAAzC,EAlBqB;AAmBnCqB,0BAAsB,EAAC3B,MAAMiB,OAAP,EAAgBZ,UAAU,IAA1B,EAAgCC,SAAS,KAAzC,EAnBa;AAoBnCsB,qBAAiB,EAAC5B,MAAMiB,OAAP,EAAgBZ,UAAU,IAA1B,EAAgCC,SAAS,KAAzC,EApBkB;AAqBnCuB,uBAAmB,CAAC,EAAC7B,MAAMT,SAASO,MAAT,CAAgBgC,KAAhB,CAAsBC,QAA7B,EAAuCC,KAAK,KAA5C,EAAmD3B,UAAU,KAA7D,EAAD,CArBgB;AAsBnC4B,QAAI,CAAChC,MAAD,CAtB+B;AAuBnCiC,aAAS,CAACZ,MAAD;AAvB0B,GAApB,EAwBd,EAACa,YAAY,MAAb,EAxBc,CAAjB;AAyBAtC,aAAWuC,KAAX,CAAiB,EAACrC,MAAM,CAAP,EAAjB;AACAF,aAAWuC,KAAX,CAAiB,EAAC3B,OAAO,CAAR,EAAjB;AACAZ,aAAWuC,KAAX,CAAiB,EAAClB,aAAa,CAAd,EAAjB;;AAEA,MAAI;AACF;AACAtB,YAAQL,SAAS8C,KAAT,CAAe,MAAf,CAAR;AACD,GAHD,CAGE,OAAOC,CAAP,EAAU;AACV1C,YAAQL,SAAS8C,KAAT,CAAe,MAAf,EAAuBxC,UAAvB,CAAR;AACD;AACD,SAAOD,KAAP;AACD,CAxCD","file":"user.js","sourcesContent":["'use strict'\nvar mongoose = require('mongoose')\nlet moment = require('moment')()\n\nmodule.exports = function () {\n\n  let Model\n\n  let UserSchema = new mongoose.Schema({\n    name: {type: String},\n    displayName: {type: String},\n    date_added: {type: Number, required: true, default: moment.valueOf()},\n    profile_url: {type: String},\n    email: {\n      type: String, trim: true, lowercase: true, required: false, minLength: 1, match: /.+\\@.+\\..+/\n    },\n    accessToken: {type: String},\n    refreshToken: {type: String},\n    email_verified: {type: Boolean},\n    provider_id: {type: String},\n    auth_id: {type: String},\n    provider: {type: String},\n    profile: {type: Object},\n    flags: [String],\n    picture_url: {type: String},\n    has_connected_bots: {type: Boolean, required: true, default: false},\n    pages_access: {type: Boolean, required: true, default: false},\n    subscriptions_access: {type: Boolean, required: true, default: false},\n    payments_access: {type: Boolean, required: true, default: false},\n    bot_subscriptions: [{type: mongoose.Schema.Types.ObjectId, ref: 'bot', required: false}],\n    ip: [String],\n    history: [Object]\n  }, {collection: 'user'})\n  UserSchema.index({name: 1})\n  UserSchema.index({email: 1})\n  UserSchema.index({provider_id: 1})\n\n  try {\n    // Throws an error if \"Name\" hasn't been registered\n    Model = mongoose.model('user')\n  } catch (e) {\n    Model = mongoose.model('user', UserSchema)\n  }\n  return Model\n}\n"]}